import fs from "fs";
import { resolveModule } from "./nodeModule.js";
const extractVersion = (packageJsonFile) => {
    const packageJson = fs.readFileSync(packageJsonFile, "utf8");
    const packageObject = JSON.parse(packageJson);
    return packageObject.version;
};
/**
 * This plugin injects metadata into the index.html file.
 * The metadata is used to help any troubleshoot activity by referencing
 * the version of the app-shell-vite-plugin and app-shell packages used by the app.
 */
const injectMetadata = () => {
    const appShellVersion = extractVersion(resolveModule("@hitachivantara/app-shell/package.json"));
    const appShellVitePluginVersion = extractVersion(resolveModule("@hitachivantara/app-shell-vite-plugin/package.json"));
    return {
        name: "vite-metadata-plugin",
        transformIndexHtml() {
            return [
                {
                    tag: "meta",
                    attrs: {
                        name: "app-shell-version",
                        content: appShellVersion
                    }
                },
                {
                    tag: "meta",
                    attrs: {
                        name: "app-shell-vite-plugin-version",
                        content: appShellVitePluginVersion
                    }
                }
            ];
        }
    };
};
export default injectMetadata;
//# sourceMappingURL=vite-metadata-plugin.js.map