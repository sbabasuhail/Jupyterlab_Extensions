{"version":3,"file":"vite-generate-base-plugin.js","sourceRoot":"","sources":["../src/vite-generate-base-plugin.ts"],"names":[],"mappings":"AAIA,OAAO,EAAE,aAAa,EAAE,MAAM,mBAAmB,CAAC;AAElD;;;;GAIG;AACH,MAAM,CAAC,OAAO,UAAU,eAAe,CACrC,cAAgC,EAChC,kBAA2B;IAE3B,MAAM,UAAU,GAAG,aAAa,CAAC,cAAc,CAAC,CAAC;IAEjD,OAAO;QACL,IAAI,EAAE,2BAA2B;QACjC,OAAO,EAAE,KAAK;QACd,kBAAkB,EAAE;YAClB,OAAO,EAAE,MAAM;YACf,SAAS,EAAE,CAAC,IAAY,EAAE,EAAE,CAAC,CAAC;gBAC5B,IAAI,EACF,kBAAkB,IAAI,cAAc,CAAC,IAAI,IAAI,IAAI;oBAC/C,CAAC,CAAC,IAAI,CAAC,OAAO,CACV,uBAAuB,EACvB,UACE,kBAAkB;wBAChB,CAAC,CAAC,oBAAoB;wBACtB,CAAC,CAAC,cAAc,CAAC,IACrB,UAAU,CACX;oBACH,CAAC,CAAC,IAAI;gBACV,IAAI,EAAE;oBACJ;wBACE,GAAG,EAAE,MAAM;wBACX,KAAK,EAAE;4BACL,IAAI,EAAE,kBAAkB,CAAC,CAAC,CAAC,mBAAmB,CAAC,CAAC,CAAC,UAAU;yBAC5D;wBACD,QAAQ,EAAE,cAAc;qBACzB;oBACD;wBACE,GAAG,EAAE,MAAM;wBACX,QAAQ,EAAE,cAAc;wBACxB,KAAK,EAAE;4BACL,GAAG,EAAE,SAAS;4BACd,EAAE,EAAE,OAAO;4BACX,IAAI,EAAE,mBAAmB;yBAC1B;qBACF;iBACF;aACF,CAAC;SACH;KACF,CAAC;AACJ,CAAC","sourcesContent":["import type { PluginOption } from \"vite\";\n\nimport type { HvAppShellConfig } from \"@hitachivantara/app-shell-shared\";\n\nimport { getPublicPath } from \"./config-utils.js\";\n\n/**\n * Add the <BASE> tag at index.html file. Tag value is obtained by the main app ({@link #getMainApp}) baseUrl ({@link #getPublicPath})â€˜\n * @param appShellConfig The app shell configuration.\n * @param generateEmptyShell Flag that controls if an empty app shell application is created with tags instead of final values\n */\nexport default function generateBaseTag(\n  appShellConfig: HvAppShellConfig,\n  generateEmptyShell: boolean\n): PluginOption {\n  const publicPath = getPublicPath(appShellConfig);\n\n  return {\n    name: \"vite-plugin-generate-base\",\n    enforce: \"pre\",\n    transformIndexHtml: {\n      enforce: \"post\",\n      transform: (html: string) => ({\n        html:\n          generateEmptyShell || appShellConfig.name != null\n            ? html.replace(\n                /<title>(.*?)<\\/title>/,\n                `<title>${\n                  generateEmptyShell\n                    ? \"%%APPSHELL_TITLE%%\"\n                    : appShellConfig.name\n                }</title>`\n              )\n            : html,\n        tags: [\n          {\n            tag: \"base\",\n            attrs: {\n              href: generateEmptyShell ? \"%%APPSHELL_BASE%%\" : publicPath\n            },\n            injectTo: \"head-prepend\"\n          },\n          {\n            tag: \"link\",\n            injectTo: \"head-prepend\",\n            attrs: {\n              rel: \"preload\",\n              as: \"image\",\n              href: \"./icons/icons.svg\"\n            }\n          }\n        ]\n      })\n    }\n  };\n}\n"]}