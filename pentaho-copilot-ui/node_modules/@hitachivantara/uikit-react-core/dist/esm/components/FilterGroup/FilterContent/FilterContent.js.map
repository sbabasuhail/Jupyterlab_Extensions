{"version":3,"file":"FilterContent.js","sources":["../../../../../src/components/FilterGroup/FilterContent/FilterContent.tsx"],"sourcesContent":["import { useContext, useMemo, useRef, useState } from \"react\";\n\nimport { Filters } from \"@hitachivantara/uikit-react-icons\";\n\nimport { useTheme } from \"@core/hooks/useTheme\";\nimport { HvActionBar } from \"@core/components/ActionBar\";\nimport {\n  HvBaseDropdown,\n  HvBaseDropdownProps,\n} from \"@core/components/BaseDropdown\";\nimport { HvButton, HvButtonVariant } from \"@core/components/Button\";\nimport { HvFormStatus } from \"@core/components/Forms\";\nimport { HvTypography } from \"@core/components/Typography\";\nimport { ExtractNames } from \"@core/utils/classes\";\nimport { setId } from \"@core/utils/setId\";\n\nimport {\n  HvFilterGroupLabels,\n  HvFilterGroupValue,\n  HvFilterGroupHorizontalPlacement,\n} from \"../types\";\nimport { staticClasses, useClasses } from \"./FilterContent.styles\";\nimport { HvFilterGroupContext } from \"../FilterGroupContext\";\nimport { HvFilterGroupCounter } from \"../Counter\";\nimport { HvFilterGroupLeftPanel } from \"../LeftPanel\";\nimport { HvFilterGroupRightPanel } from \"../RightPanel\";\n\nexport { staticClasses as filterGroupContentClasses };\n\nexport type HvFilterGroupContentClasses = ExtractNames<typeof useClasses>;\n\nexport interface HvFilterGroupContentProps\n  extends Omit<HvBaseDropdownProps, \"onChange\"> {\n  description?: React.ReactNode;\n  status?: HvFormStatus;\n  onChange?: (\n    event: React.MouseEvent<HTMLButtonElement>,\n    value?: HvFilterGroupValue\n  ) => void;\n  onCancel?: (event: React.MouseEvent<HTMLButtonElement> | Event) => void;\n  onClear?: (event: React.MouseEvent<HTMLButtonElement>) => void;\n  labels?: HvFilterGroupLabels;\n  horizontalPlacement?: HvFilterGroupHorizontalPlacement;\n  disablePortal?: boolean;\n  escapeWithReference?: boolean;\n  height?: string | number;\n  leftEmptyElement?: React.ReactNode;\n  rightEmptyElement?: React.ReactNode;\n  disabled?: boolean;\n  classes?: HvFilterGroupContentClasses;\n}\n\nexport const HvFilterGroupContent = ({\n  id,\n  status,\n  disabled = false,\n  \"aria-label\": ariaLabel,\n  \"aria-labelledby\": ariaLabelledBy,\n  description,\n  \"aria-describedby\": ariaDescribedBy,\n  onChange,\n  onCancel,\n  onClear,\n  labels,\n  horizontalPlacement = \"right\",\n  disablePortal = true,\n  escapeWithReference = true,\n  height,\n  leftEmptyElement,\n  rightEmptyElement,\n  classes: classesProp,\n  ...others\n}: HvFilterGroupContentProps) => {\n  const { classes } = useClasses(classesProp);\n  const { activeTheme } = useTheme();\n\n  const [filterGroupOpen, setFilterGroupOpen] = useState<boolean>(false);\n\n  const {\n    defaultValue,\n    filterValues,\n    rollbackFilters,\n    clearFilters,\n    applyFilters,\n    applyDisabled,\n  } = useContext(HvFilterGroupContext);\n\n  const focusTarget = useRef<HTMLDivElement>(null);\n\n  const focusOnContainer = () => {\n    focusTarget.current?.focus();\n  };\n\n  const onApplyHandler = (event: React.MouseEvent<HTMLButtonElement>) => {\n    applyFilters();\n    onChange?.(event, filterValues);\n    setFilterGroupOpen(false);\n  };\n\n  const onCancelHandler = (\n    event: React.MouseEvent<HTMLButtonElement> | Event\n  ) => {\n    rollbackFilters();\n    onCancel?.(event);\n    setFilterGroupOpen(false);\n  };\n\n  const onClearHandler = (event: React.MouseEvent<HTMLButtonElement>) => {\n    clearFilters();\n    onClear?.(event);\n  };\n\n  const handleToggle = (event: Event, open: boolean) => {\n    /* \n     If evt is null this toggle wasn't triggered by the user.\n     instead it was triggered by the baseDropdown useEffect after\n     the datepicker changed the expanded value this baseDropdown behavior needs a review\n    */\n    if (event === null) return;\n    setFilterGroupOpen(open);\n    if (!open) onCancelHandler?.(event);\n  };\n\n  const Header = useMemo(\n    () => (\n      <>\n        <Filters />\n        <HvTypography variant=\"label\">{labels?.placeholder}</HvTypography>\n      </>\n    ),\n    [labels?.placeholder]\n  );\n\n  return (\n    <HvBaseDropdown\n      id={setId(id, \"dropdown\")}\n      role=\"combobox\"\n      classes={{\n        root: classes.dropdown,\n        panel: classes.panel,\n        selection: classes.baseDropdownSelection,\n        header: classes.header,\n      }}\n      disabled={disabled}\n      disablePortal={disablePortal}\n      variableWidth\n      placement={horizontalPlacement}\n      expanded={filterGroupOpen}\n      onToggle={handleToggle}\n      onClickOutside={onCancelHandler}\n      onContainerCreation={focusOnContainer}\n      placeholder={Header}\n      adornment={<HvFilterGroupCounter />}\n      popperProps={{\n        modifiers: [{ name: \"preventOverflow\", enabled: escapeWithReference }],\n      }}\n      aria-haspopup=\"dialog\"\n      aria-label={ariaLabel}\n      aria-labelledby={ariaLabelledBy}\n      aria-invalid={status === \"invalid\" ? true : undefined}\n      aria-errormessage={status === \"invalid\" ? setId(id, \"error\") : undefined}\n      aria-describedby={\n        [description && setId(id, \"description\"), ariaDescribedBy]\n          .join(\" \")\n          .trim() || undefined\n      }\n      {...others}\n    >\n      <div ref={focusTarget} tabIndex={-1} />\n      <div className={classes.root} style={{ height }}>\n        <HvFilterGroupLeftPanel\n          id={id}\n          className={classes.leftSidePanel}\n          emptyElement={leftEmptyElement}\n        />\n        <HvFilterGroupRightPanel\n          id={id}\n          className={classes.rightSidePanel}\n          emptyElement={rightEmptyElement}\n          labels={labels}\n        />\n      </div>\n      <HvActionBar className={classes.actionBar}>\n        <HvButton\n          id={setId(id, \"clearFilters-button\")}\n          disabled={\n            defaultValue\n              ? defaultValue?.flat().length === filterValues?.flat().length\n              : filterValues?.flat().length === 0\n          }\n          variant=\"secondaryGhost\"\n          onClick={onClearHandler}\n        >\n          {labels?.clearLabel}\n        </HvButton>\n        <div aria-hidden=\"true\" className={classes.space}>\n          &nbsp;\n        </div>\n        <HvButton\n          id={setId(id, \"apply-button\")}\n          disabled={applyDisabled}\n          variant={\n            activeTheme?.filterGroup.applyButtonVariant as HvButtonVariant\n          }\n          onClick={onApplyHandler}\n          className={classes.applyButton}\n        >\n          {labels?.applyLabel}\n        </HvButton>\n        <HvButton\n          id={setId(id, \"cancel-button\")}\n          variant={\n            activeTheme?.filterGroup.cancelButtonVariant as HvButtonVariant\n          }\n          onClick={onCancelHandler}\n        >\n          {labels?.cancelLabel}\n        </HvButton>\n      </HvActionBar>\n    </HvBaseDropdown>\n  );\n};\n"],"names":["HvFilterGroupContent","id","status","disabled","ariaLabel","ariaLabelledBy","description","ariaDescribedBy","onChange","onCancel","onClear","labels","horizontalPlacement","disablePortal","escapeWithReference","height","leftEmptyElement","rightEmptyElement","classes","classesProp","others","useClasses","activeTheme","useTheme","filterGroupOpen","setFilterGroupOpen","useState","defaultValue","filterValues","rollbackFilters","clearFilters","applyFilters","applyDisabled","useContext","HvFilterGroupContext","focusTarget","useRef","focusOnContainer","current","focus","onApplyHandler","event","onCancelHandler","onClearHandler","handleToggle","open","Header","useMemo","placeholder","setId","root","dropdown","panel","selection","baseDropdownSelection","header","modifiers","name","enabled","undefined","join","trim","leftSidePanel","rightSidePanel","actionBar","flat","length","clearLabel","space","filterGroup","applyButtonVariant","applyButton","applyLabel","cancelButtonVariant","cancelLabel"],"mappings":"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"}