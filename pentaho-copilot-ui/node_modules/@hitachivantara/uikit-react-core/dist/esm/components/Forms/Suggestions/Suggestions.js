import { jsx } from "@emotion/react/jsx-runtime";
import { forwardRef, useContext, useRef, useState, useEffect } from "react";
import { useForkRef, Popper } from "@mui/material";
import { setId } from "../../../utils/setId.js";
import { useClickOutside } from "../../../hooks/useClickOutside.js";
import { useClasses } from "./Suggestions.styles.js";
import { staticClasses } from "./Suggestions.styles.js";
import { HvSelectionList } from "../../SelectionList/SelectionList.js";
import { HvListItem } from "../../ListContainer/ListItem/ListItem.js";
import { HvFormElementContext } from "../FormElement/context/FormElementContext.js";
const HvSuggestions = forwardRef((props, extRef) => {
  const {
    id,
    className,
    classes: classesProp,
    expanded = false,
    anchorEl,
    suggestionValues = [],
    onClose,
    onSuggestionSelected,
    ...others
  } = props;
  const {
    classes,
    cx
  } = useClasses(classesProp);
  const {
    elementId
  } = useContext(HvFormElementContext);
  const localId = id ?? setId(elementId, "suggestions");
  const ref = useRef(null);
  const forkedRef = useForkRef(ref, extRef);
  const [isOpen, setIsOpen] = useState(expanded);
  useClickOutside(ref, (event) => {
    setIsOpen(false);
    onClose == null ? void 0 : onClose(event);
  });
  useEffect(() => {
    setIsOpen(expanded);
  }, [expanded]);
  return /* @__PURE__ */ jsx("div", { id: localId, ref: forkedRef, className: cx(classes.root, className), ...others, children: /* @__PURE__ */ jsx(Popper, { open: isOpen, disablePortal: true, anchorEl, className: classes.popper, children: /* @__PURE__ */ jsx(HvSelectionList, { className: classes.list, id: setId(localId, "list"), onChange: onSuggestionSelected, children: suggestionValues == null ? void 0 : suggestionValues.map((item, i) => {
    const itemKey = item.id || setId("item", i);
    return /* @__PURE__ */ jsx(HvListItem, { value: item, disabled: item.disabled || void 0, children: item.label }, itemKey);
  }) }) }) });
});
export {
  HvSuggestions,
  staticClasses as suggestionsClasses
};
//# sourceMappingURL=Suggestions.js.map
